import datetime
input_raw = '''seweswweswnwseeeesenwneseeseee
wwswwwnewnenwsweneswwwwwseww
eneneeesweeneneeeswnene
nenwswwsenenwnwnenenenenwnesenwnenenenenene
eneeenwneseneeseseseswsewswseswsenwe
eeneneenenwneseneesweneene
wwwwnenenwwwwwswsww
wnwnwenwnwnwnwnenwwwnwnwnwseswnwnenw
sewsweswnwnweswswnwswe
swenwnwnenwnwnweneeswsenwswneswneswsew
seswsweseswneswswneswnwsenwswsenwswsesenw
swsenesewswnenwnewseswseenwnweseseseew
senwseswseswnwswswswseseeseseseswswesw
eeeeneeenweneeeeneesweenewwne
sewnwnwnwnwnwnwnwswnwwnenwnwnwnwnwnwnwe
swenenwneenwwnwwenwwnwwenwseswswnwe
seswseseeseswnwswswse
nenenenwswnenenenenene
wnwseswwwnwwswwswswseswnewwswseww
seeswwnenewwnwswsenewwswwwswswsww
wnesewnwwnwnenwwewsewnwneeseseswwnw
nesewsesesesesesewsweseseseseewnwsw
swswswsewseeswswswswswneswswwsewsesenesw
nesewswwwswswwwwswswwsewnwswnesew
seseesweswnweeswseenwnenweenwwe
swswnweswnwswswswseswseswswswsesesww
nwenenwsenenwnwnenenwneneneneneneneswnesw
eenwewnwsesweesesenwnewnwnwsenesw
wswswswneseseseswse
nwnwnwnwnwenwnwnwwnwsenwnwnenwnwnenew
swsesesewseeseseseseneeseenwesesesese
neseneswsenewsesenwwwswswsenweswnee
swswnwwswsweswswswwswswwwneswwswsw
swswswnewwswswnesweswwswwswnwwwww
neeesewnwnenweswswnwswsenenenwsenwsene
nwnwswnwswenwwwnwwenweenwwnwnww
neswswnwswsenwwswswsweswseswsw
neweeneneseeweeeseeeneswnweene
swenwneswsewswneswwnwswnwswswswswswwe
nenwswneswnenwsenwnenwsew
nwnwnwnenwnwswwnwnwnwneswsenenwnenenwnwnw
wseswsewnewseswswnweseseneswswnenenwse
neeeeeswneneneneneneeneeswnwnwneee
eneswneenwnenwsewswseeeenwseseew
swswswsewseeswenwseenwseswswswseswnwswse
seseeseewseseeseswsesenenwseseseeenee
neswswswswswswnwwswswwswswsewswnesww
wsenenwneneneswnwnwnenenenwnenwnenenwnw
wnwsenesenwwswsewsweenwwwwwswsw
swnwneseswseswnwswsewseswswseswswsweeswsw
seswswswnwneswswwnwswseswnwseswswswenesw
nwnwnwnwnwsenwnwnwwenwnw
nweeeeeeeeeeeswseenewsewne
neneneneseneeesenewwnwenewneneswne
nwwnwnwnwnwnwnwwwwsenwewnw
nwswnenenwneneseneneseenwnwnwnenwne
seneneneneeeenwsenenwsweeneeenenene
wnwwnwwnwswwswwnwnwnenwwwnwnwne
swwenewswwweewswswwswnwswswnwsw
newneswsenenwsenenwswesenwnwnwnenwnenese
neneswneweneneneeneneeeeeneesenw
seweseswsewsenwesenenwsese
newewseneesweswseneswnenewwsenwe
nesenwsewnwnwseswnwswsenenwewwnwsene
nwnewwsenewwnesewwse
swswesweneneneswenwswnenenesenewnee
swnwseenwnewneneseewne
nwwwnwnwenwnwwnwnwnwnw
eseseneswneseswsesenwwwsewnesesesee
nenwnwnwnwnwnwnwnwnwnenenwnwnesewsenesw
nenenenenenwneneswswnenenwwnwneneneenw
seswseswneewneswwseseswseseswswseswswse
wsewneseeseseseseneswsesesenesese
sweswswwswswswswswswswwneesweeww
neswswnwswswswswwswswsweseeswswswewsw
nwneenesenwswenenesenwswnenenewsenene
eweeeeeneeseesenwesweeeeee
wseeenwnweeswnesweeneeenenwseee
esenwseseesenwwseeeeeeeseesee
wwwnewwwswwsewwwewnewwwnwwse
swswseswseswsenwswswnwseswseswesenwese
senwseseseseenwseeseseseseeseswsesese
wewnewwswnwwnewnwswswseewwsww
wswswswswswwswswnwweeswwwwwww
eeenweewenesweeeeeseee
swwswesewswsenewwneswwwswwneeww
nwnwnenenwseneseenenwnenwnenwnenwswnenw
swwswsweeswwswwswwswneswwwnesesesw
nwneswneneneneneenwneneswnenenenenwnenw
nwwwswsewesenwwsweneswnenwseswwsw
sesesesewseneseseseseseesewsewsesesene
nenwneeswswswsewswnwnwwswneswsenew
senenwnwswnwswesewswnwnwnwnweenwneneswse
esewweeeeesenwneeseesweeeene
newwseseeseeseseseseseenwewsesese
seneseeeswweeesewneseseewseene
swseeseseeseswsewnweneswnwenesewnwse
eweneeewesenwneeneenewenesesw
wswnwneseswswnenenenwenenenewneneenw
seeneswsesewseseswnesenwseswswnwsesese
seewesewewsenewneneneswsenwesese
senwnwnwsewnwnwnwswnewnwnwenwnenenwswnwnw
swnwnwnenwwwsenwnenwnwnwnwenwwesewnwnw
seswswneswswswswswswwswneseswswwswswswsw
neseneswnenwwnenenwnwwnesenwnenwnenene
nwseseswswwswsewseswenwnwweeswesese
seneswswswseenweewswnewswwswnwswswne
sesenwswneeenwswseswswneewnenwneswe
ewewwwwwswwnwswwwnwewwww
swnenewesewwwswwsewwnwswwnwnene
wswnwsenwnwswenwnwenwnweswwwneee
weenewswswewnwnweesewnwsweswwsw
eeseeeseeeweeeseneeee
wnwenwnwnwenwnwnwnwnwswweneneswswnee
seseseswsewnwsewseeesenwseseswesese
weweesweeneeneeseeeweeseee
swseneesweenwneswnenwneewwwswswsw
nesewwenesenenwneneeneneneese
esesenewnwnweseseweeeeeeeswsw
nwswwwneswswseeswswnwswswnewsenwswesw
weeeseeseseseesesewnesenweeese
sewsesewnesesesesewneseeenesenwesese
swsesesenesenwsesewseseswseswseseswswse
neswswswwswswswswwswswswswswsw
nwnwnwnwnwnenwnwnwnwsenwnewnenw
seneneenwnwnwneswnwnwnenwnwnwnwnwnwnenw
swnweeeeeeeesew
neseswwnweeeeswseeseeeseeeswene
eeneeeseeneeseeeeewneeenwsw
senwswseesesesesweeenwseee
wwwwswwwsewswswswnewwswneswwsew
eseeneseeseswwseeweeeeneeee
wwnewwwwwwswwswwwewwwnewsew
sewwneeeeeesweeswenesesweneee
nenwnwenwnwswnwnwwswnww
swswseneswswesesenwsesewseswsesesesesenw
seeseseenwweseseseneeseeeeseese
newnenwseswwnwwwwnw
swwnewewwwwwwwwsewwwnwwwnw
swwnwnwnwswenwnwneenw
wnwnwswnenwnwweswweseswwswwewsw
nwenwnwnenwswewswnwnwenwnwnwwnwnenw
esewseseseeeeneseseeeewsenesw
swwwswwnwwnwwweswswsewwswwnesw
senwswnenwnwneenwswnwnwneenwnwnwnenwnww
wwnwwwwwwnewewwwwwsenwswsww
nwnwnwnwnwsewnwnwnwnwnw
swnweseswseseswenwwseneseneswnweswswsw
enenenewseseneseeeneneeneenenwnwne
neneneewwenesenenenenwneneneneneene
neeeneeeneneweeeneee
neseeswswswnwswwswswwswswnwswwswswsw
wwwnenewwnweseseswsenewnwnwnwwse
swwwwsewswswswswswswswwsweneswsw
seneseeseswsesesesesewseseseswsenw
nwwwwnwnwwnwsenwwwwww
wwwwwswnewewseneseswnewswwseewnw
neswnweeswneewwneeeeeneneenenese
neneeneewewsesewnwseeene
seneneneenwnwnwnwnenwnwnenwnwnenwnwswwe
wswswwwseswneswwswwsw
nenwnwesewneneewwwseswwsw
wnewnwwwwwnwnwewwwwswewseww
seeeeseenwsenweswsesesesenwseseee
nenwwsenenwnwnenwnenwnenenesenwnwnwnwnw
wwnwsewwswnewwswewwwwwwsww
seseseeeeseesenwseseseseseese
nweseseseswenesesesesewseseseseseneese
nwswswswwswsweswwsweswswswswswneswsw
wwwsewwwsewwwwwnwwenewnww
nwwnwwwwnwwsesenenwnwwwnwnwwwnw
newnewsewswneenesenenenenenwnesenwe
wnwswswnwwenwnweenwnwewnw
newnenesweneseenenenee
nesweneneneneseewneweeweewswee
wwwwswwwwwwwewww
nwnwsweswwnwnewnwnwnwnenwswwnwneswnw
esenesewswswswswswseswseseswswsw
nwnenenwwnesenenesweneswnenenenesenene
swwewnwwnewwwweswnwsewwnwnenw
swwwneseweseswwswneneswneneseswswnesw
nenwwneneneswnenenenenwnenenenesenw
swswswswseswswnwswseswswsw
swswswsweseswswswwswswswswneswswwsww
neseswseswseswswneneswswsewwswneswswsw
swwswwswwwswnwwwwwwswesww
swswsesewnwswswswseseseswswswne
nwseswswswswswseswseswse
sesewwsesewseesenesenwwseseesesesee
swnwwswswswsweswswwswswswswswswsw
nwnenenwnwnwsenenwwnwsenwseewnwesenww
wwswnwwwwenwwwwwnwsenewewwne
wsenesenwwnesenesenww
eeeeeswnwseseeeseneswenwsewswsee
swwwewwwewwswwwswnw
eeneswnweeswseeenwseeswnwweseee
nenwnwswneenenenwwnenwswneneneneneeenwsw
seseseswneesewwsenwseseesese
newnenenenwneseneenewnenenenesenenenenw
nenwswweseeswsenwsenwsewneswseneswnw
eeneewsenweeeneesewee
nwwnwwsewnwwwwwnwnenwsenweww
neneneswnewnenwneneswnenenenenenenwnesene
seseeseseswseesesenwseseswswsesenwsww
seeswnenwswwnenesenenwnwnwnenenenenene
wneneneswnenenwnwwee
newswwwwsewnwseswneenwwseewnewne
swswwwwswneeswwweseswnew
swnwseeseeewesweneeswenwswwwne
eweseeeeeeeeeenweseeeeenw
wwnwwsenewwwwwwnwnewseswswwsew
neeseseeeesesesesesesesenwsewsesew
nwnenwnenenenenwnwnenenenenenwenenesesw
senenenwnenenenenenewneneneene
senwseswwseswswseseneswswswswsenwseee
nenwwnesenenwseswsenewnenwswnenese
nenwnwnwsenwnwnwwwnwnwwwwnwwnw
seseeswsenwneeeesewwsenesenenwsewse
eeseeesenwseesweeewenwsesesee
eswnwnwwsenwnwnwwnwwne
swswsesenwswseswswswesw
nwwnwwnwnwnwnwnwnwse
newsesenwnwsewsenenewwse
swnwnwwsenwnwnenenwnwnenwnw
swswwnewewwsesenewnwseswswswswswsw
eeeneseeeseseeseeeweseese
neneneneneneseswenweseneweenewnwene
nwnwwnwnwnwnwnwnwwnwnwnwnwnwesenwnenw
senenenewswseeenwswesweeneene
nwnwnwenwnwnwnewsenwnwnenwsenenenwnwwnw
nwswswswseswswnwswswseswesenwswswswseseswsw
senwwnesenwswseseswseseswenwswesesee
weeseeeeseenee
nwnenwnwswnwnwnwnweswnenwswsee
wwwnewwwnwewneswneswnwswwsenwnww
wseswneeseseswenwsesenwnenewse
seneenwswnewneneeeeneeeneneneenenwne
sweneweeseeeseeeneewseee
eswseseenwsesesesewseenenwswnwseeswse
swneswwnwwwwwwseswwswwswswwsene
sesenesewswsesenesesesesesesesesesesese
weneweswewseseeeeneeseeenee
seeseeseenesweseesweeeeswneenwe
weseewnweeeswseseeeswswnewsenene
nenesenenenwnwnenesenenenwnenwwnwnwnenesew
nwweeeeeeeeeeseeseee
neswnenenenwnenenenwnwnwnwnenwne
neneenweeeswwseeswswenweweswnenw
wnwnwnwswewnwwwnewwnewnwwsenwnw
seeswseseswnewnwsesesesesesesesenewnwse
wnewsewewwwnwnwweeswwwnwswnw
seeseeseeeeeeeeeeenwweneew
eeeeseenwsweesenwnweeesenwswee
swwswnwseswswswswswswsweneswswswswswsw
nwnenwwnwwnwenwnwnwsenwnwnwnwwnwnww
swnewneneenewnenwswnwsenewnwneesee
wwwwwsewwwwnwnewnwwnenwseswnw
swsewweweswwwswnwwewwnewwwe
wnwenwswswwwwwwwwwwswewwne
nenenenenenenenenenenesesenenwnenwwnenwe
nwnenwenwenwwnwsenwnwnwwsenwnwnwwnwnw
seswnwnenwenwseswwenesenewneswnwnwnene
enenenwswnwnwnwnenenesenwnwsenwwnwnwnw
swsewwsewseenwnwnewnwwwnwnwnewse
seseswnwswswswswwseswne
nwwnwsewnwnwnwnwnwnwnwnwnwenwnwswnwnwe
swnenenesesenenenenwnenenewnesewneenene
seswsewswseseswseswswswnewneseswseswse
nwsewsenwnwnwwnwnwwswnewnenwwsewwwnw
seeeeseneswnwneenenwnenwneesenwe
wwneeenewseeesesesesweeesesese
swwswswsewseswswneneewneeswnwsesewe
nwneswswswsweswseswswswswseswswswnewswsw
nwnwwsenwwnwnwnwnwwwwnwnwenwsenwww
neenwswnwneenwnwwnwnenwnwswnwswnwnwe
nwswnwnwnwwnwswnwnwnwnwswneewnwnwnwnwenw
swswneseswseeeeeeseseneseesenwsewe
neseesesesewseweeweeneswseeeene
swseeswsesewswswseseeswseswnwsenwswnese
swwswwswsewswwswnwswseswwnenwswsww
nwneewnwnwnwnwwnwnwnwnwseswwnenwnwnwse
nwnwenenwnwnwnwwwenenewneswe
eseeneeneneeseneweenweneeewsw
wswswswsewswswnewweswnewwwswwwsw
newnenenwenenenenwnene
swwnwwswwwswwwenwwwewwwswwsw
neneeneneswwneneenenwseneeneneneeenwne
newnwswsweswseseswnwnwswswswseseswnee
eneeneeneweneneneswnweneesenenene
sweeeswnwneeneneenweeeneesw
neswsenwesesesesweseseweseseeeese
nwseswnwnwswneneenwnwnwwwnenesenenwnenw
sweeeeseeneesweseesenwneesweee
wwswneesewnwseseeeeweswesewsww
sesweswswseeswswsenwswswswwseswneswsesww
swneneneeseneenewnew
sesewsesenwnwesesesewseeeseswsesesese
swseswseswswewswnenwswneenwnwneswne
neneneneneneneneswenenenenwsw
weswwnwwwnwwswswnwnwewweeenwnw
wnwwwwwnwwswwnwnwsewnwwnwwwewe
nwwswwswnwneswsewseeswseseswnewnenwnesw
nwnwnweswsenwsenwswnesenwwnwsenwswee
nwwneseswswweseswseswswnenewseswswnww
eeesweneenwneeeneneswesewneswneene
weeneswswewseeeeeeenwneee
nwnwnwenwnwnwnwwwnwsewsewwwnenwnw
neenenwwneneeswseneswnewnene
enwnwnwnwnwnwnwnwnwenwsenwnwwswnwnwnwnwnw
wnwswseseneseseseswsesesewsenweeseew
swnweswnesenesewseneseseseenweeseew
nwseeeseseeseesesenwswneseseweseesw
wwwswwswneswwwwweww
seswwenwseneewneeneeswneneeswnwnew
nwswseswwwneswswswswwnwseswswesweswsw
sewswwwwswswsenwsenewwwwwwnwsww
nenenenenenwswnenenenenenenene
seseneseseesenwswsewseswswseseseswseseese
swwnesewnwseneswnenesweeeneswewne
nwnwnwwwnwwnwwnwnwswewenwnwnwnwnw
nwnwnwswwnwwsesenwnwwnwsenwenweneswnwnw
seswseeswnwseseswseswseswseseswseseswnw
swswsweswswsenewneswswsenwwswswswswe
sweswswswwwswswwnewwswnewswswnesw
weseseswswseseswsese
wnwwnwwwwwwwewwnwnw
neseeeseeswnwwnesee
nenesewswnesenenenwwnwnenweseeswwenw
seseseneswwsewnwweeeewnesesesesese
seswnewnwsenwswseseswsenwseesesesesesesese
neneneswnenwnwnesenenenenwnenesenesenenene
swneswswnewsenesweswseswwseswswswswsesw
nwnwneswsweeeneeneeeneneesenwnenene
senwnwswnwnweswwnwsenwswnwnesenwswwee
eneseswenwneseswneesenwwneeweewwsw
seewswswswenwnwwwnwnwnwwnwnwwnwne
eneenwnewswnwnewsewseneeswnwenesww
nenesenenenenwnesesenesewnenwnenwwnenese
eenesewsweeeweseweeeseneseee
weneeseesenesesesesesesesewesesee
swswwswwwswwwswnwswwnesweswwneswwsw
neswneseneneewnenenwsenwnenewneneenew
neseeswsweswwseeneenenewwnenwene
eeeneeneeeeweeeeee
nwenwwwwnwwwwwwwnw
nwswnwnwnwnwwnwnwnwnwsenwsewenwnwnwnw
swseneneneswnenenwnenenwneneswnenenenee
nenwnenwsenwnwnwwnwnenwnene
eeneeeeneeeeeeenesw
esweeeweseeeneneeenwseeswnwswswne
nenenenwnesenwnenenwnenenenenene
swnwewswwswnwswwswswnesweswswswwse
wenwneneenesweeneneeeeseneenenwe
nwnewnwnwenwswswnwnenwsenwee
wswnwesenwwswswewneswwweweswwnenw
seweswneeswneswneneeneneneneenewnesee
nenwnwnewneeneeeesweneneswneneswne
nenwenenenenenesweneneneeenenewee
nesenwneneneneneneseneswnwnenenenwnewse
wnwwsesewsewwswwneswneswwnewswww
nwnwsenenwnwnwnwnwwwenenwwwwswwww
neeseeeseseeseeseeesw
neneneswnwneneseneswwneseeneewne
nwswsewwswswewwwwwwwwwnwswsw
swswseseneseesenesenwswsesesesese
eenwwseswwwswsweeswswswswswswsese
eswneswswswswswnewwswswswweswenwe
nwseseswseswswseseseseseswnwseseneswsesw
swseeswenwseeeeseseneseseeeesenee
seeseswwwsesewseseseseseeeenwesee
seswswseseseseseseseeswenwswswswnwsesenese
nwnwwnwsenwwnwnwnwwnwnwnw
nenwnwswnwnweswnwnwenenwneeneswnwnenw
neenewneneneneeneenenwewnesenenene
swswwwnwwnenwswsesewsewww
nwnwnwwneeswswnwesenwnwsewnwwenwnwsww
wsewwwnenwsewwwsewwnewnwwsww
neeneneesweswneeewsweneneenenwenee
nwnewneeneneeseswesewenwneswneewe
wswwnewswswswswneswswswwwswsw
nwwwneneswsenewnwneeeswsweneswenwe
wswswswwswnenewewswswswwnwswseswsewsw
newwnwnwnwnenwnweswnenwnenwnwsenenene
nenwnenenenenenenwwnweneswnenenwsesenew
sesenwnewnwnwnwswsweswnwswwwwsewsee
wnwnwsenwnwnwnwnwenenwseeswnenwswnwsesw
nwnwwnwnwnenwsenwnwswnwenwswnwwenwnw
eeeeseseseeeeeweseneweesee
eswesewenweneeneeseseeseeeee
enenewnenenenenesweswnewnesenenenenenene
swnweeenwnenwnwewneswnewwswwenw
sweswseeesweeeeneeseeeeeneesenw
wnwnwswnwnenwnwnwnwnwneswnweswnwnenenw
swswswswswswwswwnwswsweswswewswwsw
nwenwnewwnwswwnwnwesenwsesenewnwnwnw
wwswwwwwwwwsenw
swwnwsewwnewwnwswnwnewwnwnwnwne
eeeesenweeenenenenweeeeswe
enesweswswewswswseswnwswnw
eswseswnwsenwsewesenenewwwseesenwse
sesewwnewwnewwwewwwnwswnwwww
nenenewnenenenenesenenenenenenenene
nenwnenenwnenwnewnwnenesenenwneswnwnwswne
seseeswnwnwseswsesewseeseseesewesenw
swsenewsewswseneseseeeeseswnweenwse
eswwnwwwewwswne
sewseneewswswseswwseeseswewseswnw
wswwwwwsewwwwwwwwwnwsenew
wnwnenenwswwwwewswsewwwesenwe
wweewnwnwsesenwwewnwwwwwsww
neenwneneeswnwnwneseenesene
nenwsenewnwnenwneswnenenwenwwne
neeseneenwneseenwseenewneswneenesew
nwnwnewnwnwwneswenwnwnwwnwsenwsenwwnw
neneweneseneewwswwnwnwsenwnewnenesene
nwnwnwnwnwnwnwnwnwwswenewnwnwnwenwnesw
weseeneeneeeeseeesesenwnwswswese
senenesewnenenwnenenenewnenenenene
wnwsenwnwwsenwnewwnwenwwwnwnwnww
enwnwnwnwnwsweswnwsenwnwwneneswwnwe
eswnenenwneneweneneeneenenenenwswe
nesesewseswseseeseswsesenesesesesenese
swnwneswnenenwswesweeesweewnweenwsw
swnwnwswswswwseneewwneewswwswswsw
ewnwswnenwwwswnwsenwnwnwnwwwwwnewnw
seseseseseeeesenw
nwnwwnwswwenwwnwnwnwnwswnwnwnwenwnwnw
nenwnenenenesenwnwswnwneneswnwenenwneese
wnwwwwswwewewwwwswnewwwsww
nwswsewswwswneswswnewswwswseswnwww
neenewneneneswenwwnewnwnwnenwsesenw
seseesesesesesesesesweswwsenwsesesese
nwewnwswneseseseewsesenwseseseeseese
ewneeeeeeesweewenewse
wnwwwwwwwwnwnwwsenenwwwwenw
wseswswswswwnenenwwewenwswnew
nenwsenenwnwnwnwnwwnwnwnw
wneeneenenenwsesewnewwsenenwswswsw
eeeeenweeswewsweeeeeenwee
wenwseswseswswnwswswswswneswseswseee
nenenwnwwenwnwnwnwnwnwnwnw
wsewwwnwnewwwwwwwwsewwww
wwwwswnwwswwswewenwswwwwnwswwse
seneswwwwewnewwwwswwswwswwwe
nesewswneswswnwwwsewwwwswswwnesw
swewseswnwnwswweseeswwswnwnweswsw
nwnwnwenwnwswwsenewswnwnwnwnweenwnwsw
swenwswswseswswswswswswswswwswseseese
nwseswnwneswwswwnweeswewnwnwwwew
nwseswwnwenwewwnwnwswwnwnwnwnwseww
enweneeeeeeeenwsweesweew
nesenenwnwwwnwwswnwnwnwwnwwse
weneeeseseneeenweeeneneenwewe
senwnwnwnwswneneswnwnwnewnwsenwwnesee
nwneseneswnenenwnwnwwnw
wnwnwwswnwnwnwnwesewnwnwswnwnwwnwnenwe
nwswwswswwseewsweseswneeneseesew
enwwnwwswwswenwwsweenwnwewnwse
seewwwswnwwswwwwswswewwswswwnw
nenwnenwneenwsenenewnwwnenwnwnenwnw
swswseseswswswneswswswswswswsesweswsenwsene
neneneswswneneseneweswnenwseswseswwsw
wwweneswwwwwswsenew
swswswnwseswswswswswswswsw
nwnenesenenwnenwnwnwnw
eeesenwseeswseeeenwneswseeenwsenew
seeeeseseeswsesenweeeewsewsese
swseneswswseneswnwswswseseswseseswwsewsesw
nwswnenenwneenwsenwswnwnenenwnwnwsenenwsw
nwseseeeenwswswnwswese
nweneneenenwsenenenenese
wswswswwwwewwwneswwesewneswwswnw
nwsenwwnenwnenwsenewnwnwnesenenenwnwne
nenwswnwenwseswnenwwnwnwnwnwwenwnenenw
wseswweswenenwswwswseneewwwnew
seeswseseesewenenwswewe
swswwswswsenenwneswseswswswswswswswswsw
wnwsewsenenenwnwsewnwwenenwswnwnwsenw
seneeseeneswsesenweseswweeswsenwswe
nenenenwnwneenewesesenenenenewsenenene
eneeneeeeeeeeseenew'''

input = input_raw.split("\n")

input_test_raw = '''sesenwnenenewseeswwswswwnenewsewsw
neeenesenwnwwswnenewnwwsewnenwseswesw
seswneswswsenwwnwse
nwnwneseeswswnenewneswwnewseswneseene
swweswneswnenwsewnwneneseenw
eesenwseswswnenwswnwnwsewwnwsene
sewnenenenesenwsewnenwwwse
wenwwweseeeweswwwnwwe
wsweesenenewnwwnwsenewsenwwsesesenwne
neeswseenwwswnwswswnw
nenwswwsewswnenenewsenwsenwnesesenew
enewnwewneswsewnwswenweswnenwsenwsw
sweneswneswneneenwnewenewwneswswnese
swwesenesewenwneswnwwneseswwne
enesenwswwswneneswsenwnewswseenwsese
wnwnesenesenenwwnenwsewesewsesesew
nenewswnwewswnenesenwnesewesw
eneswnwswnwsenenwnwnwwseeswneewsenese
neswnwewnwnwseenwseesewsenwsweewe
wseweeenwnesenwwwswnew'''

input_test = input_test_raw.split("\n")

# Uncomment this row to use test input
#input = input_test

# Idea: https://stackoverflow.com/questions/11373122/best-way-to-store-a-triangular-hexagonal-grid-in-python
#    _____       _____      ____      __
#   / -2,2\_____/ 0,1 \____/2,0 \____/  \__ 
#   \_____/-1,1 \____/ 1,0\____/3,-1\__/   
#   /-2,1 \_____/0,0  \____/2,-1\____/  \__     
#   \_____/-1,0 \_____/1,-1\____/3,-2\__/   
#   /-2,0 \_____/ 0,-1\____/2,-2\____/  \__ 
#   \_____/     \_____/    \____/    \__/   
#       ___w___
#    sw/       \ nw 
#     /   0,0   \
#   se\         / ne
#      \___e___/ 

# Parse input:
dir_map = {
    'w' : (0,1),
    'e' : (0,-1),
    'a' : (-1,0), #se
    'b' : (-1,1), #sw
    'c' : (1,0), #nw
    'd' : (1,-1) #ne
}

moves = []
for row in input:
    directions = list(row.replace('se','a').replace('sw','b').replace('nw','c').replace('ne','d'))
    move = []
    for d in directions:
        move.append(dir_map[d])
    moves.append(move)

# PART 1
# Time tracking
p1_start_time = datetime.datetime.now() 
tiles = {(0,0):True} # True = white, False = black
for move in moves:
    current_pos = (0,0)
    for direction in move:
        current_pos = tuple(sum(t) for t in zip(current_pos, direction))
    if(current_pos in tiles):
        tiles[current_pos] = not(tiles[current_pos])
    else:
        tiles[current_pos] = False

black_count = 0
for tile in tiles:
    if (tiles[tile] == False):
        black_count +=1

print('-'*10 + 'PART 1' + '-'*10)
print('Part 1 answer: {}'.format(black_count))
p1_end_time = datetime.datetime.now() 
print('Part 1 time: {}'.format(p1_end_time - p1_start_time))

# PART 2
# Count number of black tiles adjacent to a given tile
def count_black(all_tiles, pos):
    c = 0
    for direction in [(0,1),(0,-1),(-1,0),(-1,1),(1,0),(1,-1)]:
        adjacent_pos = tuple(sum(t) for t in zip(pos, direction))
        if(adjacent_pos in all_tiles and all_tiles[adjacent_pos] == False):
            c += 1
    return c

# Main PART 2
# Time tracking
p2_start_time = datetime.datetime.now()
N_DAYS = 100
print('-'*10 + 'PART 2' + '-'*10)
for d in range(1,N_DAYS+1):
    # Each day, populate tiles that are adjacents to black tiles if such tiles are not existing yet
    all_tiles = list(tiles.keys())
    for tile in all_tiles:
        if tiles[tile]: # Skip white tiles
            continue
        for direction in [(0,1),(0,-1),(-1,0),(-1,1),(1,0),(1,-1)]:
            adjacent_pos = tuple(sum(t) for t in zip(tile, direction))
            if(adjacent_pos not in tiles):
                tiles[adjacent_pos] = True
    
    # Scan all populated tiles, check which tiles need to be flipped
    flips = []
    for tile in tiles:
        if tiles[tile]: #white
            if(count_black(tiles, tile) == 2):
                flips.append(tile)
        else: # black tile
            c = count_black(tiles, tile)
            if(c==0 or c > 2):
                flips.append(tile)
    
    # Flip all marked tiles simultaneously
    for tile in flips:
        tiles[tile] = not(tiles[tile])

    # Count black tiles after flipping
    black_count = 0
    for tile in tiles:
        if (tiles[tile] == False):
            black_count +=1

    # progress tracking
    if d%5  == 0:
        print('Processed {:,} days ({:.2%})'.format(d, d/N_DAYS))            
    #prdnt('Day {}: {}'.format(d, black_count))

print('Part 2 answer: {}'.format(black_count))
p2_end_time = datetime.datetime.now() 
print('Part 2 time: {}'.format(p2_end_time - p2_start_time))
